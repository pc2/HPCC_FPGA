

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Multi-FPGA Benchmarking &mdash; HPCC FPGA Documentation  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=53b48696" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="prev" title="JSON Output" href="../json_output/index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            HPCC FPGA Documentation
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Benchmark Descriptions:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../STREAM/index.html">STREAM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../RandomAccess/index.html">RandomAccess</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../FFT/index.html">FFT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../GEMM/index.html">GEMM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PTRANS/index.html">PTRANS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../LINPACK/index.html">LINPACK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../b_eff/index.html">b_eff</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Technical Support:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../Basic%20Setup/index.html">Basic Build Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Host%20Input%20Parameters/index.html">Execution of a Benchmark</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Project%20Structure/index.html">Structure of the Benchmark Suite</a></li>
<li class="toctree-l1"><a class="reference internal" href="../json_output/index.html">JSON Output</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Multi-FPGA Benchmarking</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#execution-of-a-multi-fpga-benchmark">Execution of a multi-FPGA benchmark</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Benchmark Results:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../FFT/results/index.html">FFT FPGA Benchmark Results</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../GEMM/results/index.html">GEMM FPGA Benchmark Results</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../RandomAccess/results/index.html">RandomAccess FPGA Benchmark Results</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../STREAM/results/index.html">STREAM FPGA Benchmark Results</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">HPCC FPGA Documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Multi-FPGA Benchmarking</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">

           <div itemprop="articleBody">
             
  <section id="multi-fpga-benchmarking">
<h1>Multi-FPGA Benchmarking<a class="headerlink" href="#multi-fpga-benchmarking" title="Link to this heading"></a></h1>
<p>The benchmarks of the HPCC FPGA benchmark suite support the execution on multiple FPGAs.
It tries to keep the execution model close to the original one of the HPCC benchmark for CPU which distinguishes between <cite>global</cite> and <cite>embarrassingly parallel</cite> execution.
The difference is, that for the global execution, the calculation of a single problem is done with all available resources.
So the FPGAs will need to communicate and exchange data during calculation.
On the other hand, with embarrassingly parallel execution, every FPGA works on a dedicated data set, so no communication is needed during the calculation.</p>
<p>The benchmarks can be divided as follows:</p>
<dl class="simple">
<dt>Global:</dt><dd><ul class="simple">
<li><p><a class="reference internal" href="../../RandomAccess/index.html#randomaccess"><span class="std std-ref">RandomAccess</span></a></p></li>
<li><p><a class="reference internal" href="../../FFT/index.html#fft"><span class="std std-ref">FFT</span></a></p></li>
<li><p><a class="reference internal" href="../../PTRANS/index.html#ptrans"><span class="std std-ref">PTRANS</span></a></p></li>
<li><p><a class="reference internal" href="../../LINPACK/index.html#hpl"><span class="std std-ref">LINPACK</span></a></p></li>
<li><p><a class="reference internal" href="../../b_eff/index.html#beff"><span class="std std-ref">b_eff</span></a></p></li>
</ul>
</dd>
<dt>Embarrassingly Parallel:</dt><dd><ul class="simple">
<li><p><a class="reference internal" href="../../STREAM/index.html#stream"><span class="std std-ref">STREAM</span></a></p></li>
<li><p><a class="reference internal" href="../../GEMM/index.html#gemm"><span class="std std-ref">GEMM</span></a></p></li>
</ul>
</dd>
</dl>
<p>Independent of the used parallelization scheme, the benchmarks configuration of the benchmarks is nearly the same as described in the next section.</p>
<section id="execution-of-a-multi-fpga-benchmark">
<h2>Execution of a multi-FPGA benchmark<a class="headerlink" href="#execution-of-a-multi-fpga-benchmark" title="Link to this heading"></a></h2>
<p>A host process of the benchmark will always only handle a single FPGA device.
Nevertheless, multiple host processes can communicate over MPI to execute a benchmark in parallel and synchronize the data.
If multiple FPGAs are available on a single host, they can be utilized by executing multiple MPI ranks on this host.
The FPGAs will be assigned to the MPI ranks in a round-robin scheme so the device ID for every MPI rank is calculated with <span class="math notranslate nohighlight">\(id = mpi\_rank\ mod\ \#devices\)</span>.</p>
<p>As an example we execute STREAM with two MPI ranks and two kernel replications each:</p>
<div class="highlight-Bash notranslate"><div class="highlight"><pre><span></span>mpirun<span class="w"> </span>-n<span class="w"> </span><span class="m">2</span><span class="w"> </span>.STREAM_FPGA_intel<span class="w"> </span>-f<span class="w"> </span>kernel.aocx<span class="w"> </span>-r<span class="w"> </span><span class="m">2</span><span class="w"> </span>-s<span class="w"> </span><span class="m">1024</span>
</pre></div>
</div>
<p>This will execute STREAM on each FPGA with an array size of 1024 elements.
These 1024 elements will be distributed amongst the two kernel replication such that every kernel replication will work on arrays of size 512.
Since the execution includes two MPI ranks and the input sizes will be scaled by the number of ranks, the total size of the arrays will be <span class="math notranslate nohighlight">\(1024 \cdot 2 = 2048\)</span>.
This also holds for all other benchmarks, so the basic rule of thumb is:</p>
<p><em>The data size specified in the benchmark configuration will be multiplied by the number of MPI ranks and then equally distributed to the total available kernel replications</em></p>
</section>
</section>


           </div>
          </div>
    <a href="https://github.com/pc2/hpcc_fpga">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub">
    </a>

          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../json_output/index.html" class="btn btn-neutral float-left" title="JSON Output" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Marius Meyer.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>